<div class="container">
    <h2 class="text-center mb-5">Admin Dashboard</h2>

    <div class="mb-5">
        <h3 class="mb-3">Users</h3>
        <form method="get" class="d-flex mb-3" (ngSubmit)="searchUser()">
            <input type="text" id="userSearch" name="searchUser" placeholder="Search users by username..." [(ngModel)]="userSearchText">
            <button type="submit" class="btn btn-primary ms-2">Search</button>
            <button type="button" class="btn btn-secondary ms-2" (click)="resetUserSearch()">Reset</button>
        </form>
        <ul class="list-group shadow-sm rounded">
            <li *ngFor="let user of filteredUsers" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ user.name }}</strong><br>
                    <span class="text-muted">Username: {{ user.username }}</span><br>
                    <span class="text-muted">Email: {{ user.email }}</span>
                </div>
                <div>
                    <form *ngIf="!user.admin" method="post" class="d-inline">
                        <button type="submit" class="btn btn-danger btn-sm me-1" (click)="deleteUser(user)">Delete</button>
                    </form>
                    <button type="button" class="btn btn-info btn-sm" routerLink="/seller/profile/{{ user.username }}">View</button>
                </div>
            </li>
            <div *ngIf="users.length == 0">
                <li class="list-group-item text-muted text-center">No users found</li>
            </div>
        </ul>
    </div>

    <div class="mb-5">
        <h3 class="mb-3">Products</h3>
        <form method="get" class="d-flex mb-3" (ngSubmit)="searchProduct()">
            <input type="text" id="userSearch" name="searchUser" placeholder="Search users by username..." [(ngModel)]="productSearchText">
            <button type="submit" class="btn btn-primary ms-2">Search</button>
            <button type="button" class="btn btn-secondary ms-2" (click)="resetProductSearch()">Reset</button>
        </form>
        <ul class="list-group shadow-sm rounded">
            <li *ngFor="let product of filteredProducts" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ product.name }}</strong><br>
                    <span class="text-muted">Seller: {{ product.user.username }}</span>
                </div>
                <div>
                    <form method="post" class="d-inline">
                        <button type="submit" class="btn btn-danger btn-sm me-1" (click)="deleteProduct(product)">Delete</button>
                    </form>
                    <button type="button" class="btn btn-info btn-sm" routerLink="/product-detail/{{ product.id }}">View</button>
                </div>
            </li>
            <div *ngIf="products.length == 0">
                <li class="list-group-item text-muted text-center">No products found.</li>
            </div>
        </ul>
    </div>

    <div class="mb-5">
        <h3 class="mb-3">Comments</h3>
        <form method="get" class="d-flex mb-3" (ngSubmit)="searchComment()">
            <input type="text" id="userSearch" name="searchUser" placeholder="Search users by username..." [(ngModel)]="commentSearchText">
            <button type="submit" class="btn btn-primary ms-2">Search</button>
            <button type="button" class="btn btn-secondary ms-2" (click)="resetCommentSearch()">Reset</button>
        </form>
        <ul class="list-group shadow-sm rounded">
            <li *ngFor="let comment of filteredComments" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ comment.user.username }}</strong> commented on <strong>{{ comment.seller.username }}</strong>: 
                    <span class="fst-italic">"{{ comment.text }}"</span>
                </div>
                <button type="button" class="btn btn-danger btn-sm me-1" (click)="deleteComment(comment.id)">Delete</button>
            </li>
            <div *ngIf="comments.length == 0">
                <li class="list-group-item text-muted text-center">No comments found.</li>
            </div>
        </ul>
    </div>

    <div class="mb-5">
        <h3 class="mb-3">Orders</h3>
        <form method="get" class="d-flex mb-3" (ngSubmit)="searchOrder()">
            <input type="text" id="userSearch" name="searchUser" placeholder="Search users by username..." [(ngModel)]="orderSearchText">
            <button type="submit" class="btn btn-primary ms-2">Search</button>
            <button type="button" class="btn btn-secondary ms-2" (click)="resetOrderSearch()">Reset</button>
        </form>
        <ul class="list-group shadow-sm rounded">
            <li *ngFor="let order of filteredOrders" class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ order.user.username }}</strong> ordered:
                    <div *ngFor="let product of order.products" class="d-inline">
                        <span class="badge bg-secondary">{{ product.name }}</span>
                    </div>
                    <br>
                    <span class="text-muted">on {{ order.date }}</span>
                </div>
            </li>
            <div *ngIf="orders.length == 0">
                <li class="list-group-item text-muted text-center">No orders found.</li>
            </div>
        </ul>
    </div>
</div>
