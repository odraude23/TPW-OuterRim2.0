<div class="container " style="margin-top: 100px;">
    <div class="row">
      <!-- Sidebar for selecting conversations -->
      <div class="col-md-4">
        <h4 class="text-center">Conversations</h4>
        <ul class="list-group">
          <li
            *ngFor="let contact of contacts"
            class="list-group-item text-center"
            [ngClass]="{ active: contact === selectedUser }"
            (click)="selectUser(contact)"
            [style.backgroundColor]="contact === selectedUser ? '#4a90e2' : '#f7f7f7'"
            [style.color]="contact === selectedUser ? 'white' : '#333'"
            style="border: 1px solid #ddd; cursor: pointer;"
          >
            <span style="color: inherit; padding: 10px 15px;">
              {{ contact.name }}
            </span>
          </li>
        </ul>
      </div>
  
      <!-- Chat window for the selected conversation -->
      <div class="col-md-8">
        <h4 class="text-center">
          Conversation with {{ selectedUser?.name || 'No User Selected' }}
        </h4>
  
        <div
          class="chat-box"
          *ngIf="selectedUser"
          style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; background-color: #ffffff;"
        >
          <div
            *ngFor="let message of chatMessages"
            class="message"
            [ngClass]="{
              'text-end': message.sender.id === currentUser?.id,
              'text-start': message.sender.id !== currentUser?.id
            }"
          >
            <div
              class="p-2 rounded mb-2"
              [ngClass]="{
                'bg-sender text-white': message.sender.id === currentUser?.id,
                'bg-receiver text-dark': message.sender.id !== currentUser?.id
              }"
              style="display: inline-block; max-width: 70%;"
            >
              <strong *ngIf="message.sender.id === currentUser?.id">You:</strong>
              <strong *ngIf="message.sender.id !== currentUser?.id">{{ message.sender.name }}:</strong>
              <p class="mb-0">{{ message.text }}</p>
              <small class="text-muted">{{ message.createdAt | date: 'short' }}</small>
            </div>
          </div>
  
          <p *ngIf="chatMessages.length === 0" class="text-muted">No messages yet.</p>
        </div>
  
        <!-- Placeholder when no user is selected -->
        <p *ngIf="!selectedUser" class="text-muted text-center mt-5">
          Please select a user to start a conversation.
        </p>
  
        <!-- Message input form -->
        <form
          *ngIf="selectedUser"
          (submit)="sendMessage(); $event.preventDefault()"
          class="mt-3"
        >
          <div class="input-group">
            <textarea
              [(ngModel)]="newMessageText"
              name="message"
              class="form-control"
              placeholder="Type your message..."
              rows="1"
              style="min-width: 90%;"
              required
            ></textarea>
            <button type="submit" class="btn btn-primary">Send</button>
          </div>
        </form>
      </div>
    </div>
</div>  